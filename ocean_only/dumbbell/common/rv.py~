import netCDF4 as nc
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
p_rv=nc.Dataset('../z/prog.nc').variables['RV']
rv=nc.Dataset('prog.nc').variables['RV']
def rv_sfc(i):
    return rv[i,0,:]*1.e4
def p_rv_sfc(i):
    return p_rv[i,0,:]*1.e4

i=0
im1 = ax1.imshow(p_rv_sfc(i), animated=True,vmin=-3,vmax=3,cmap=plt.cm.plasma,interpolation='spline16')
im2 = ax2.imshow(rv_sfc(i), animated=True,vmin=-3,vmax=3,cmap=plt.cm.plasma,interpolation='spline16')
plt.title('Layer 1 Relative Vorticity 10**-4 m s-2')

def updatefig(*args):
    global i
    i += 1
    im1.set_array(rv_sfc(i))
    im1.set_array(p_rv_sfc(i))    
#    im.title('Layer 1 Relative Vorticity at t= '+str(i))
    return im1,im2,

ani = animation.FuncAnimation(fig, updatefig, interval=5, blit=True)
plt.show()
